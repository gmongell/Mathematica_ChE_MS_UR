(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     13115,        397]
NotebookOptionsPosition[     11376,        333]
NotebookOutlinePosition[     11787,        351]
CellTagsIndexPosition[     11744,        348]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
ME201/MTH281/ME400/CHE400
Fourier Series for a Square Wave\
\>", "Title",
 Evaluatable->False,
 CellChangeTimes->{{3.389543283353119*^9, 3.3895432879414997`*^9}, {
  3.4519047412723017`*^9, 3.4519047419205427`*^9}, {3.461692274504915*^9, 
  3.461692278470963*^9}, {3.4730142790747633`*^9, 3.4730142824417953`*^9}, {
  3.473694796269948*^9, 3.473694797972108*^9}},
 AspectRatioFixed->True],

Cell[CellGroupData[{

Cell["1. Introduction", "Section",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell["\<\
\tIn this notebook we look at the numerical convergence of the Fourier series \
for a square wave.  Later we will also take a graphical look at the \
convergence.  The notebook is written so that it easily can be modified to \
study the convergence of the Fourier series of a different function.  The \
specific function used is defined in section 2.  \
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.473014306714324*^9, 3.4730143295066338`*^9}},
 AspectRatioFixed->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. Definition of Function and Fourier Coefficients", "Section",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell["\<\
\tIn the definitions below, we first define the function over a basic \
interval [-L,L], then specify the value of L, and finally  extend the \
function periodically.  The specific example here is the square wave.  The \
name used for the basic function defined over [-L,L] is fbas.  The \
periodically extended function is called f.\
\>", "Text",
 Evaluatable->False,
 CellChangeTimes->{{3.473014355059169*^9, 3.4730143927636127`*^9}},
 AspectRatioFixed->True],

Cell["fbas[x_] := -1 /; -L <= x < 0 (* Square Wave *)", "Input",
 AspectRatioFixed->True],

Cell["fbas[x_] := 1 /; 0 <= x < L", "Input",
 AspectRatioFixed->True],

Cell["L = 1;", "Input",
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{"fbas", "[", 
   RowBox[{"Mod", "[", 
    RowBox[{"x", ",", 
     RowBox[{"2", "*", "L"}], ",", 
     RowBox[{"-", "L"}]}], "]"}], "]"}]}]], "Input"],

Cell[TextData[{
 "\tThe function Mod[x, 2*L, -L] (1) adds L to x, (2) calculates the \
remainder on dividing (1) by 2*L, (3) subtracts L from (2).  This has the \
effect of shifting the original ",
 StyleBox["x ",
  FontSlant->"Italic"],
 "by \[PlusMinus]2L until it falls into the range [-L,L).  This modified ",
 StyleBox["x ",
  FontSlant->"Italic"],
 "is then used as the argument of the original function f[x].  "
}], "Text",
 CellChangeTimes->{{3.473014741947027*^9, 3.473014743450007*^9}}],

Cell["\<\
\tWe plot the periodically extended function over three periods -- that is \
over [-3L, 3L].\
\>", "Text",
 CellChangeTimes->{{3.473015094352043*^9, 3.473015129632532*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", " ", 
    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.451904635031938*^9, 3.451904646686211*^9}, {
  3.473015260748992*^9, 3.473015262539377*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"-", "3"}], "*", "L"}], ",", 
     RowBox[{"3", "*", "L"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<f[x]\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.3895429110284348`*^9, {3.473015139443939*^9, 3.473015145043601*^9}, {
   3.473015181441072*^9, 3.473015196043775*^9}, {3.4730152365815067`*^9, 
   3.473015240028037*^9}}],

Cell["\<\
\tStrictly speaking the vertical lines shown on the graph at the \
discontinuity are not part of the graph.  In some ways they make it easier to \
visualize the discontinuous function, but on those days when we are feeling \
fussy, we can exclude those segments.  This is done by an Option for plot \
called Exclusions.  The plot without the vertical lines is constructed below. \
 The argument of the Option Exclusions is a list of points to be excluded. \
\>", "Text",
 CellChangeTimes->{{3.4730148102345*^9, 3.473014928580731*^9}, {
  3.473015012736971*^9, 3.473015057630969*^9}}],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"f", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{
      RowBox[{"-", "3"}], "*", "L"}], ",", 
     RowBox[{"3", "*", "L"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<x\>\"", ",", "\"\<f[x]\>\""}], "}"}]}], ",", 
   RowBox[{"Exclusions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2.0"}], ",", 
      RowBox[{"-", "1.0"}], ",", "0.0", ",", "1.0", ",", "2.0"}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.3895429110284348`*^9, {3.4730149455936193`*^9, 3.473014967088613*^9}, {
   3.473015278167099*^9, 3.473015346838499*^9}}],

Cell["\<\
\tWe give here the Fourier coefficients for the function f (in this case the \
square wave).  We assume these have been calculated elsewhere, and the values \
are supplied here in the definitions of the coefficients.  We denote the \
cosine coefficients by a[n] and the sine coefficients by b[n].  For \
convenience in later calculations, we define b[0] = 0.\
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "n_", "]"}], "=", "0.0"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "0", "]"}], "=", "0"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "[", "n_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"EvenQ", "[", "n", "]"}], ",", "0", ",", 
    RowBox[{"(", 
     RowBox[{"4", "/", 
      RowBox[{"(", 
       RowBox[{"n", "*", "\[Pi]"}], ")"}]}], ")"}]}], "]"}]}]], "Input"],

Cell["\<\
\tEvenQ is a logical function which returns True if its argument is even, \
False otherwise.  The If statement then returns 0 for even n and 4/(n\[Pi]) \
for odd n.  \
\>", "Text",
 CellChangeTimes->{{3.473015398958062*^9, 3.473015424557459*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Terms and Partial Sums of Fourier Series", "Section",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell["\<\
     Now we define the nth term of the Fourier series, called fourterm.\
\>", "Text",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"fourterm", "[", 
   RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "n", "]"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "\[Pi]", " ", "x"}], ")"}], "/", "L"}], "]"}]}], 
    "+", 
    RowBox[{
     RowBox[{"b", "[", "n", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", " ", "\[Pi]", " ", "x"}], ")"}], "/", "L"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.4730154443655663`*^9, 3.4730155438978148`*^9}}],

Cell["     The pth partial sum of the series is foursum, given by", "Text",
 Evaluatable->False,
 CellChangeTimes->{3.473015954254681*^9},
 AspectRatioFixed->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"foursum", "[", 
   RowBox[{"x_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"fourterm", "[", 
     RowBox[{"x", ",", "n"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "p"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.4730155678534184`*^9, 3.4730156037621317`*^9}, {
  3.473015961649928*^9, 3.473015982128477*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. Numerical Values of the Partial Sums", "Section",
 Evaluatable->False,
 AspectRatioFixed->True],

Cell["\<\
\tWe construct a table of values showing how the sum of the series depends on \
both x and on the number of terms kept in the partial sum.  We use 10 values \
of x, namely 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, and 0.5.  We \
consider the mth partial sum with the indexing being such that we add up the \
first m non-zero terms to get the mth partial sum. For example, for m = 20, \
we will add up the harmonics corresponding to n = 1, 3, 5, ... 39.  Our table \
will be for m = 10, 20, 40, 80, and 160.
\
\>", "Text",
 CellChangeTimes->{{3.473015881160378*^9, 3.473015893518509*^9}, 
   3.473016018952372*^9}],

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"foursum", "[", 
      RowBox[{
       RowBox[{"i", "*", "0.05"}], ",", 
       RowBox[{
        RowBox[{"10", "*", 
         RowBox[{"2", "^", "j"}]}], "-", "1"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "5"}], "}"}]}], "]"}], ",", 
   RowBox[{"TableHeadings", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<x=0.05\>\"", ",", "\"\<x=0.10\>\"", ",", "\"\<x=0.15\>\"", ",", 
        "\"\<x=0.20\>\"", ",", "\"\<x=0.25\>\"", ",", "\"\<x=0.30\>\"", ",", 
        "\"\<x=0.35\>\"", ",", "\"\<x=0.40\>\"", ",", "\"\<x=0.45\>\"", ",", 
        "\"\<x=0.50\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<m = 10\>\"", ",", "\"\<m = 20\>\"", ",", "\"\<m = 40\>\"", ",", 
        "\"\<m = 80\>\"", ",", "\"\<m = 160\>\""}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473016032580823*^9, 3.473016041084804*^9}}],

Cell["\<\
\tNotice that a large number of terms are required for accuracy.  This is a \
consequence of the slow decay of the Fourier coefficients with increasing n \
-- they drop off only like 1/n.  Notice also that more terms are required for \
accuracy for points near a discontinuity, such as x = 0.05.  For example, \
there is still a 5% error at x = 0.05 even when m = 40, whereas the error at \
x = 0.5 (maximum distance from a discontinuity) is slightly less than 1% for \
m = 40.  Finally notice the surprisingly large overshoot at x = 0.05 when m = \
10 -- nearly 18% above the actual value of the function.  This is not a \
numerical error.  The overshoot is real.  Surprisingly, it does not go away \
as m increases, but simply moves ever closer to the discontinuity.  This is \
called the Gibbs phenomenon, after the American mathematical physicist \
Willard Gibbs who first explained the overshoot.  Very shortly, we will see a \
graphical view of all of this, which will provide more insight than the bare \
numbers above.\
\>", "Text",
 CellChangeTimes->{{3.4730160661875143`*^9, 3.473016091937993*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{640, 750},
WindowMargins->{{0, Automatic}, {Automatic, -22}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 23, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 398, 9, 123, "Title",
 Evaluatable->False],
Cell[CellGroupData[{
Cell[1002, 35, 80, 2, 67, "Section",
 Evaluatable->False],
Cell[1085, 39, 490, 9, 71, "Text",
 Evaluatable->False]
}, Open  ]],
Cell[CellGroupData[{
Cell[1612, 53, 115, 2, 67, "Section",
 Evaluatable->False],
Cell[1730, 57, 471, 9, 56, "Text",
 Evaluatable->False],
Cell[2204, 68, 89, 1, 27, "Input"],
Cell[2296, 71, 69, 1, 27, "Input"],
Cell[2368, 74, 48, 1, 27, "Input"],
Cell[2419, 77, 223, 7, 27, "Input"],
Cell[2645, 86, 496, 11, 56, "Text"],
Cell[3144, 99, 182, 4, 26, "Text"],
Cell[3329, 105, 269, 6, 27, "Input"],
Cell[3601, 113, 680, 19, 43, "Input"],
Cell[4284, 134, 593, 9, 86, "Text"],
Cell[4880, 145, 817, 24, 43, "Input"],
Cell[5700, 171, 428, 8, 71, "Text",
 Evaluatable->False],
Cell[6131, 181, 99, 3, 27, "Input"],
Cell[6233, 186, 96, 3, 70, "Input"],
Cell[6332, 191, 286, 9, 70, "Input"],
Cell[6621, 202, 256, 5, 70, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6914, 212, 108, 2, 70, "Section",
 Evaluatable->False],
Cell[7025, 216, 141, 4, 70, "Text",
 Evaluatable->False],
Cell[7169, 222, 616, 20, 70, "Input"],
Cell[7788, 244, 163, 3, 70, "Text",
 Evaluatable->False],
Cell[7954, 249, 407, 11, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8398, 265, 104, 2, 70, "Section",
 Evaluatable->False],
Cell[8505, 269, 631, 11, 70, "Text"],
Cell[9139, 282, 1088, 29, 70, "Input"],
Cell[10230, 313, 1118, 16, 70, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

